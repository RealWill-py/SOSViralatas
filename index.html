<!DOCTYPE html>
<html lang="pt-BR" class="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>S.O.S Viralatas by Andrea | Resgate e Ado√ß√£o Premium (Firebase)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            transition: background-color 0.4s, color 0.4s;
        }
        /* Nova Paleta e Estilos */
        .dark body {
            background-color: #1f2937; 
            color: #f3f4f6; 
        }
        .light body {
            background-color: #f9fafb; 
            color: #111827; 
        }
        .input-style {
            transition: border-color 0.3s, box-shadow 0.3s;
            border-radius: 0.5rem; 
        }
        .input-style:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(251, 113, 133, 0.5); 
        }
        .cat-dog-animation {
            position: absolute;
            top: 50%;
            height: 60px; 
            font-size: 48px; 
            white-space: nowrap;
            animation: move-across-reverse 4s linear forwards;
            transform: translateY(-50%) translateX(100%); 
            z-index: 50; 
        }
        @keyframes move-across-reverse {
            0% {
                transform: translateY(-50%) translateX(100vw); 
            }
            100% {
                transform: translateY(-50%) translateX(-100%); 
            }
        }
    </style>
    <script type="module" src="https://unpkg.com/lucide@latest"></script>

    <meta name="apple-mobile-web-app-capable" content="yes">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üíñ</text></svg>">
    
    <script type="module">
        
        // =======================================================
        // üö® CONFIGURA√á√ÉO E BIBLIOTECAS DO FIREBASE
        // =======================================================
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getFirestore, collection, getDocs, doc, getDoc, setDoc, addDoc, updateDoc, deleteDoc, query, orderBy, limit, onSnapshot } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
        import { getAuth, signInWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
        
        // ---------------------------------------------
        // Inicializa√ß√£o do Firebase - SUBSTITUA AQUI!
        // ---------------------------------------------
        const firebaseConfig = {
            apiKey: "SEU_API_KEY_AQUI", 
            authDomain: "SEU_AUTHDOMAIN_AQUI",
            projectId: "SEU_PROJECT_ID_AQUI",
            storageBucket: "SEU_STORAGE_BUCKET_AQUI",
            messagingSenderId: "SEU_MESSAGING_SENDER_ID_AQUI",
            appId: "SEU_APP_ID_AQUI"
        };
        
        // Inicializa o app e os servi√ßos
        let app, db, auth;
        let isAdminLoggedIn = false;
        let currentUserId = null;

        try {
            app = initializeApp(firebaseConfig);
            db = getFirestore(app);
            auth = getAuth(app);
            console.log("Firebase inicializado com sucesso.");
        } catch(e) {
            console.error("Erro ao inicializar Firebase. Verifique suas credenciais e a importa√ß√£o dos m√≥dulos:", e);
        }

        // Cole√ß√µes do Firestore
        const COLLECTIONS = {
            ANIMALS: 'animals',
            STATUS: 'status', 
            CONFIG: 'config', 
            INTERESTS: 'adoptionInterests'
        };

        // Elementos da UI
        const adminSection = document.getElementById('admin-section');
        const publicSection = document.getElementById('public-section');
        const loginSection = document.getElementById('login-section');
        const animalsListPublic = document.getElementById('animals-list-public');
        const presentationTextElement = document.getElementById('presentation-text');
        const adminToggleBtn = document.getElementById('toggle-admin');
        const themeToggleBtn = document.getElementById('theme-toggle');
        const headerElement = document.getElementById('main-header'); 
        const statusDocRef = doc(db, COLLECTIONS.STATUS, 'global');
        const configDocRef = doc(db, COLLECTIONS.CONFIG, 'global');
        
        // Estado da Admin View
        let currentAdminView = 'dashboard'; 
        let appStatus = {};
        let appConfig = {};
        let interestsList = [];
        
        // Vari√°vel para o Easter Egg
        let themeToggleClickCount = 0;
        const EASTER_EGG_LIMIT = 13;


        // =======================================================
        // 1. AUTENTICA√á√ÉO E L√ìGICA DE VISUALIZA√á√ÉO
        // =======================================================

        /** Verifica o estado da autentica√ß√£o (Login) */
        onAuthStateChanged(auth, (user) => {
            if (user) {
                // Usu√°rio logado
                isAdminLoggedIn = true;
                currentUserId = user.uid;
                if (loginSection.classList.contains('hidden') === false) {
                   setView('admin'); // Vai para a √°rea admin ap√≥s login
                }
                document.getElementById('current-user-id').textContent = user.email || user.uid;
            } else {
                // Usu√°rio deslogado
                isAdminLoggedIn = false;
                currentUserId = null;
                // Se estava na admin, volta para a p√∫blica
                if (adminSection.classList.contains('hidden') === false) {
                    setView('public');
                }
                document.getElementById('current-user-id').textContent = 'Admin (Deslogado)';
            }
            // Garante que o estado correto seja exibido
            if (!loginSection.classList.contains('hidden')) {
                 adminToggleBtn.innerHTML = '<i data-lucide="x" class="w-6 h-6"></i>';
            }
            lucide.createIcons();
        });


        /** * Gerencia a visibilidade das se√ß√µes principais
         * @param {string} view 'public', 'login', ou 'admin'
         */
        function setView(view) {
            publicSection.classList.add('hidden');
            loginSection.classList.add('hidden');
            adminSection.classList.add('hidden');

            adminToggleBtn.classList.remove('bg-rose-400', 'text-gray-800', 'hover:bg-rose-500'); 
            adminToggleBtn.classList.remove('bg-red-500', 'text-white', 'hover:bg-red-600');
            
            if (view === 'public') {
                publicSection.classList.remove('hidden');
                adminToggleBtn.innerHTML = '<i data-lucide="settings" class="w-6 h-6"></i>';
                adminToggleBtn.classList.add('bg-rose-400', 'text-gray-800', 'hover:bg-rose-500'); 
            } else {
                adminToggleBtn.innerHTML = '<i data-lucide="x" class="w-6 h-6"></i>';
                adminToggleBtn.classList.add('bg-red-500', 'text-white', 'hover:bg-red-600');

                if (view === 'login') {
                    loginSection.classList.remove('hidden');
                } else if (view === 'admin' && isAdminLoggedIn) {
                    adminSection.classList.remove('hidden');
                    setAdminView(currentAdminView); 
                    // Ouve as mudan√ßas de dados ao entrar no admin
                    startRealtimeListeners();
                } else if (view === 'admin' && !isAdminLoggedIn) {
                    setView('login'); // Se tentar ir para admin sem login, vai para login
                }
            }
            lucide.createIcons();
        }

        /** * Gerencia a visibilidade dos blocos da √°rea admin
         * @param {string} view 'dashboard', 'animals', ou 'config'
         */
        function setAdminView(view) {
            currentAdminView = view;
            const views = {
                dashboard: document.getElementById('admin-dashboard-block'),
                animals: document.getElementById('admin-animals-block'),
                config: document.getElementById('admin-config-block')
            };

            document.querySelectorAll('#admin-nav button').forEach(btn => {
                if (btn.dataset.view === view) {
                    btn.classList.add('bg-sky-500', 'text-white');
                    btn.classList.remove('bg-gray-200', 'dark:bg-gray-700', 'text-gray-800', 'dark:text-gray-200');
                } else {
                    btn.classList.remove('bg-sky-500', 'text-white');
                    btn.classList.add('bg-gray-200', 'dark:bg-gray-700', 'text-gray-800', 'dark:text-gray-200');
                }
            });

            for (const key in views) {
                views[key].classList.add('hidden');
            }
            views[view].classList.remove('hidden');

            // A√ß√µes espec√≠ficas ao mudar de view
            if (view === 'config') {
                populateGlobalConfigForm();
                populateManagedCountersForm();
            }
        }

        // Listener para a navega√ß√£o Admin
        document.querySelectorAll('#admin-nav button').forEach(btn => {
            btn.addEventListener('click', () => setAdminView(btn.dataset.view));
        });

        // Listener para alternar a visualiza√ß√£o entre P√∫blico e Login/Admin
        adminToggleBtn.addEventListener('click', () => {
            if (publicSection.classList.contains('hidden') === false) {
                setView('login'); // Abre a tela de login
            } 
            else {
                if (isAdminLoggedIn) {
                    handleLogout(); // Faz logout se j√° estiver logado
                } else {
                    setView('public'); // Volta para a tela p√∫blica
                }
            }
        });

        // Listener para login
        document.getElementById('admin-login-form').addEventListener('submit', handleLogin);


        /** Lida com o Login */
        async function handleLogin(e) {
            e.preventDefault();
            const email = e.target.email.value;
            const password = e.target.password.value;
            const loginErrorMessage = document.getElementById('login-error-message');
            loginErrorMessage.textContent = '';
            
            try {
                await signInWithEmailAndPassword(auth, email, password);
                // onAuthStateChanged cuidar√° da transi√ß√£o para a view 'admin'
                showModal("Bem-vindo, Andrea!", "Login de administra√ß√£o realizado com sucesso.");
                e.target.reset(); 
            } catch (error) {
                console.error("Erro no login:", error);
                loginErrorMessage.textContent = 'Erro no login: Credenciais inv√°lidas ou o usu√°rio n√£o existe.';
            }
        }

        /** Lida com o Logout */
        async function handleLogout() {
            try {
                await signOut(auth);
                // onAuthStateChanged cuidar√° da transi√ß√£o para a view 'public'
                showModal("Sess√£o Encerrada", "Voc√™ saiu da √°rea administrativa.");
            } catch (error) {
                console.error("Erro ao sair:", error);
                showModal("Erro", "N√£o foi poss√≠vel encerrar a sess√£o.");
            }
        }

        /** Alterna entre modo escuro e claro E gerencia o Easter Egg */
        themeToggleBtn.addEventListener('click', () => {
            // 1. L√≥gica do Tema
            document.documentElement.classList.toggle('dark');
            const isDark = document.documentElement.classList.contains('dark');
            themeToggleBtn.innerHTML = isDark 
                ? '<i data-lucide="sun" class="w-6 h-6 text-rose-400"></i>' 
                : '<i data-lucide="moon" class="w-6 h-6 text-gray-800"></i>';
            lucide.createIcons();

            // 2. L√≥gica do Easter Egg
            themeToggleClickCount++;
            if (themeToggleClickCount >= EASTER_EGG_LIMIT) {
                themeToggleClickCount = 0; 
                triggerEasterEgg();
            }
        });
        
        /** Ativa a anima√ß√£o do gato e do c√£o */
        function triggerEasterEgg() {
            if (!headerElement) return;
            const animationElement = document.createElement('div');
            animationElement.className = 'cat-dog-animation'; 
            animationElement.innerHTML = 'üêàüêï'; 
            headerElement.appendChild(animationElement);
            setTimeout(() => {
                animationElement.remove();
            }, 4100);
        }

        // =======================================================
        // 2. SINCRONIZA√á√ÉO COM FIRESTORE (Realtime e Inicial)
        // =======================================================
        
        /** Inicia todos os listeners de tempo real (Admin Dashboard) */
        function startRealtimeListeners() {
             // Listener para Status/Contadores e Texto de Apresenta√ß√£o (Global)
            onSnapshot(statusDocRef, (docSnap) => {
                if (docSnap.exists()) {
                    appStatus = docSnap.data();
                    renderPublicStatus(); 
                    renderAdminIndicators();
                } else {
                    console.log("Documento de Status Global n√£o encontrado.");
                }
            });

            // Listener para Interessados (Dashboard Admin)
            const qInterests = query(collection(db, COLLECTIONS.INTERESTS), orderBy('dataSubmissao', 'desc'), limit(15));
            onSnapshot(qInterests, (querySnapshot) => {
                interestsList = [];
                querySnapshot.forEach((doc) => {
                    interestsList.push({ id: doc.id, ...doc.data() });
                });
                renderInterestsListAdmin(interestsList);
                renderAdminIndicators(); // Para atualizar o contador
            });
            
            // Listener para Animais (P√∫blico e Admin)
            const qAnimals = query(collection(db, COLLECTIONS.ANIMALS), orderBy('dataCriacao', 'desc'));
            onSnapshot(qAnimals, (querySnapshot) => {
                let animals = [];
                querySnapshot.forEach((doc) => {
                    animals.push({ id: doc.id, ...doc.data() });
                });
                renderAnimals(animals, isAdminLoggedIn);
            });
        }


        /** Carrega a configura√ß√£o inicial (uma √∫nica vez) */
        async function loadInitialData() {
            try {
                // 1. Carregar Configura√ß√µes (Contatos e Links)
                const configSnap = await getDoc(configDocRef);
                if (configSnap.exists()) {
                    appConfig = configSnap.data();
                    renderPublicConfig();
                } else {
                    console.log("Documento de Configura√ß√£o Global n√£o encontrado.");
                    // Cria um placeholder se n√£o existir
                    await setDoc(configDocRef, { 
                        email: 'contato@sosviralatas.org', 
                        telefone: '(XX) 9XXXX-XXXX', 
                        instagram: '@sosviralatas', 
                        mapsLink: 'http://maps.google.com/0' 
                    });
                }
                
                // 2. Incrementar e carregar Status/Views
                await incrementSiteView();
                
            } catch(e) {
                console.error("Erro ao carregar dados iniciais:", e);
            }
        }
        
        /** Incrementa o contador de visitas do site. */
        async function incrementSiteView() {
            if (isAdminLoggedIn) return; // N√£o conta a visualiza√ß√£o do Admin logado

            try {
                // Tenta atualizar o campo site_views_count, adicionando 1.
                // Firebase.FieldValue.increment n√£o existe no m√≥dulo importado. 
                // Fazemos a leitura, incremento manual, e escrita (√© at√¥mico, mas requer regras de seguran√ßa adequadas).
                
                const snap = await getDoc(statusDocRef);
                let views = 0;
                if (snap.exists() && snap.data().site_views_count) {
                    views = snap.data().site_views_count;
                }
                
                await setDoc(statusDocRef, { 
                    site_views_count: views + 1, 
                    // Preserva outros campos se existirem, ou define um default
                    presentation_text: snap.exists() ? snap.data().presentation_text : 'Bem-vindos ao S.O.S Viralatas by Andrea! Nossa miss√£o √© dar uma segunda chance a c√£es e gatos resgatados, encontrando lares amorosos para eles.'
                }, { merge: true });
                
            } catch (e) {
                 console.error("Erro ao incrementar views. Verifique as regras de seguran√ßa do Firestore:", e);
            }
        }


        // =======================================================
        // 3. RENDERIZA√á√ÉO E ADMIN (Fun√ß√µes de UI)
        // =======================================================

        /** Renderiza o texto de apresenta√ß√£o e os contadores na p√°gina p√∫blica. */
        function renderPublicStatus() {
            presentationTextElement.textContent = appStatus.presentation_text || 'Carregando...';

            document.getElementById('resgatados-count').textContent = appStatus.resgatados_count || 0;
            document.getElementById('adotados-count').textContent = appStatus.adotados_count || 0;
            document.getElementById('adocao-count').textContent = appStatus.aguardando_adocao_count || 0;
            document.getElementById('site-views-count').textContent = appStatus.site_views_count || 0;
        }

        /** Renderiza os indicadores no topo do Painel Admin. */
        function renderAdminIndicators() {
            document.getElementById('admin-views-count').textContent = appStatus.site_views_count || 0;
            // A contagem de animais dispon√≠veis e a lista de interesses v√™m dos listeners
            document.getElementById('admin-available-animals').textContent = document.getElementById('animals-list-admin').children.length; 
            document.getElementById('interests-count').textContent = interestsList.length; 
            document.getElementById('adotados-count-dashboard').textContent = appStatus.adotados_count || 0;
        }

        /** Renderiza contatos e link do mapa na √°rea p√∫blica. */
        function renderPublicConfig() {
            document.getElementById('public-email').textContent = appConfig.email || 'N/A';
            document.getElementById('public-phone').textContent = appConfig.telefone || 'N/A';
            document.getElementById('public-instagram').textContent = appConfig.instagram || 'N/A';
            document.getElementById('public-maps-link').href = appConfig.mapsLink || '#';
            document.getElementById('public-maps-link').target = '_blank';
        }

        /** Renderiza a lista de interessados na Dashboard Admin. */
        function renderInterestsListAdmin(list) {
            const container = document.getElementById('adoption-interests-list');
            container.innerHTML = '';

            if (list.length === 0) {
                container.innerHTML = '<p class="text-center text-gray-500 dark:text-gray-400 p-4">Nenhum interessado registrado ainda. üíñ</p>';
                return;
            }
            
            list.forEach(item => {
                const itemDate = new Date(item.dataSubmissao).toLocaleDateString('pt-BR');
                const listItem = document.createElement('li');
                listItem.className = 'bg-white dark:bg-gray-700 p-4 rounded-lg shadow border border-sky-100 dark:border-sky-800 flex justify-between items-center mb-2';
                listItem.innerHTML = `
                    <div>
                        <p class="font-bold text-lg text-rose-500">${item.nome} (${itemDate})</p>
                        <p class="text-sm text-gray-600 dark:text-gray-300">Animal: <span class="font-semibold">${item.animalNome}</span></p>
                        <p class="text-sm text-gray-600 dark:text-gray-300">üìû ${item.telefone}</p>
                        <p class="text-xs text-gray-500 dark:text-gray-400">üìß ${item.email}</p>
                    </div>
                    <button data-id="${item.id}" data-action="delete-interest" class="delete-interest-btn bg-red-500 hover:bg-red-600 text-white p-2 rounded-full transition-colors flex items-center space-x-1 shadow-md">
                        <i data-lucide="check" class="w-4 h-4"></i>
                    </button>
                `;
                container.appendChild(listItem);
            });
            lucide.createIcons();
        }

        /** Renderiza as listas de animais na √°rea p√∫blica e administrativa. */
        function renderAnimals(animals, isAdminView) {
            document.getElementById('animals-list-admin').innerHTML = '';
            animalsListPublic.innerHTML = '';

            if (animals.length === 0) {
                animalsListPublic.innerHTML = '<p class="text-center text-gray-500 dark:text-gray-400 p-4">Nenhum animal resgatado cadastrado ainda. üêæ</p>';
                document.getElementById('animals-list-admin').innerHTML = '<li class="text-gray-500 dark:text-gray-400 p-4">A lista est√° vazia. Adicione um novo animal acima!</li>';
                return;
            }

            // Renderiza na √Årea P√∫blica (Landing Page)
            animals.slice(0, 6).forEach(animal => { // Mostra apenas os 6 mais recentes
                const card = createAnimalCard(animal, false);
                animalsListPublic.appendChild(card);
            });

            // Renderiza na √Årea Administrativa (Se logado)
            if (isAdminView) {
                animals.forEach(animal => {
                    const listItem = createAnimalCard(animal, true);
                    document.getElementById('animals-list-admin').appendChild(listItem);
                });
            }
            renderAdminIndicators();
        }

        /** Cria o card/item de animal. */
        function createAnimalCard(animal, isAdmin) {
            const container = document.createElement(isAdmin ? 'li' : 'div');
            container.className = isAdmin 
                ? 'bg-white dark:bg-gray-800 p-4 rounded-xl shadow-lg flex flex-col md:flex-row items-center space-y-3 md:space-y-0 md:space-x-4 mb-4 transition-colors border border-gray-200 dark:border-gray-700' 
                : 'bg-white dark:bg-gray-800 rounded-2xl shadow-2xl overflow-hidden transform hover:scale-[1.02] transition-all duration-300 border border-rose-100 dark:border-rose-900';
            
            const imageUrl = animal.imagemUrl && animal.imagemUrl.startsWith('http') 
                ? animal.imagemUrl 
                : `https://placehold.co/400x300/F472B6/FFFFFF?text=üêæ+${animal.nome}`; /* Pink/Rose */

            if (isAdmin) {
                container.innerHTML = `
                    <img src="${imageUrl}" onerror="this.onerror=null;this.src='https://placehold.co/64x64/F472B6/FFFFFF?text=üêæ';" alt="Foto de ${animal.nome}" class="w-16 h-16 object-cover rounded-full flex-shrink-0 border-2 border-rose-400">
                    <div class="flex-grow min-w-0">
                        <h3 class="text-xl font-bold text-sky-600 dark:text-sky-400 truncate">${animal.nome}</h3>
                        <p class="text-sm text-gray-600 dark:text-gray-300">${animal.raca} - ${animal.idade} ano(s)</p>
                    </div>
                    <div class="flex space-x-2 mt-3 md:mt-0 flex-shrink-0">
                        <button data-id="${animal.id}" data-action="edit" class="edit-btn bg-sky-400 hover:bg-sky-500 text-gray-800 p-2 rounded-lg text-sm transition-colors flex items-center space-x-1 shadow-md">
                            <i data-lucide="pencil" class="w-4 h-4"></i>
                        </button>
                        <button data-id="${animal.id}" data-action="delete" class="delete-btn bg-red-500 hover:bg-red-600 text-white p-2 rounded-lg text-sm transition-colors flex items-center space-x-1 shadow-md">
                            <i data-lucide="trash-2" class="w-4 h-4"></i>
                        </button>
                    </div>
                `;
                container.querySelector('.edit-btn').addEventListener('click', () => editAnimal(animal));
                container.querySelector('.delete-btn').addEventListener('click', () => deleteAnimal(animal.id, animal.nome));
            } else {
                container.innerHTML = `
                    <img src="${imageUrl}" onerror="this.onerror=null;this.src='https://placehold.co/400x300/F472B6/FFFFFF?text=S.O.S+Viralatas';" alt="Foto de ${animal.nome}" class="w-full h-48 object-cover">
                    <div class="p-5">
                        <h3 class="text-2xl font-extrabold text-gray-800 dark:text-gray-100">${animal.nome}</h3>
                        <p class="text-sm text-rose-500 font-semibold mb-3">${animal.raca} - ${animal.idade} ano(s)</p>
                        <p class="text-gray-600 dark:text-gray-300 text-sm mb-4 line-clamp-3">${animal.descricao}</p>
                        <button data-id="${animal.id}" data-name="${animal.nome}" class="interest-btn w-full bg-rose-500 hover:bg-rose-600 text-white font-bold py-3 rounded-lg transition-colors shadow-lg flex items-center justify-center space-x-2">
                            <i data-lucide="heart" class="w-5 h-5"></i>
                            <span>Quero Adotar</span>
                        </button>
                    </div>
                `;
                container.querySelector('.interest-btn').addEventListener('click', (e) => {
                    const id = e.currentTarget.dataset.id;
                    const name = e.currentTarget.dataset.name;
                    openAdoptionModal(id, name);
                });
            }
            lucide.createIcons();
            return container;
        }

        // =======================================================
        // 4. CRUD DE ANIMAIS (Firestore)
        // =======================================================
        
        let isEditing = false;
        let currentAnimalId = null;

        /** Abre o formul√°rio para adicionar ou editar um animal. */
        function openAnimalForm(animal = null) {
            const form = document.getElementById('animal-form');
            document.getElementById('animal-form-title').textContent = animal ? `Editar Animal: ${animal.nome}` : 'Adicionar Novo Animal';
            isEditing = !!animal;
            currentAnimalId = animal ? animal.id : null;
            form.reset();

            if (animal) {
                form.nome.value = animal.nome || '';
                form.raca.value = animal.raca || '';
                form.idade.value = animal.idade || '';
                form.sexo.value = animal.sexo || '';
                form.imagemUrl.value = animal.imagemUrl || '';
                form.descricao.value = animal.descricao || '';
            }

            document.getElementById('animal-modal').classList.remove('hidden');
        }
        
        document.getElementById('add-animal-btn').addEventListener('click', () => openAnimalForm());
        document.getElementById('animal-modal-close').addEventListener('click', () => {
            document.getElementById('animal-modal').classList.add('hidden');
        });

        function editAnimal(animal) {
            openAnimalForm(animal);
        }

        document.getElementById('animal-form').addEventListener('submit', handleSaveAnimal);

        /** Salva ou atualiza um animal no Firestore. */
        async function handleSaveAnimal(e) {
            e.preventDefault();
            if (!isAdminLoggedIn) { showModal("Acesso Negado", "Voc√™ precisa estar logado como Admin."); return; }

            const animalData = {
                nome: e.target.nome.value.trim(),
                raca: e.target.raca.value.trim(),
                idade: parseInt(e.target.idade.value) || 0,
                sexo: e.target.sexo.value,
                imagemUrl: e.target.imagemUrl.value.trim(),
                descricao: e.target.descricao.value.trim(),
                dataCriacao: new Date().getTime() // Carimbo de data/hora atual (para ordena√ß√£o)
            };

            const modal = document.getElementById('animal-modal');

            try {
                if (isEditing && currentAnimalId) {
                    // Atualiza
                    const animalRef = doc(db, COLLECTIONS.ANIMALS, currentAnimalId);
                    await updateDoc(animalRef, animalData);
                    showModal("Sucesso", `Animal ${animalData.nome} atualizado no Firebase!`);
                } else {
                    // Adiciona
                    await addDoc(collection(db, COLLECTIONS.ANIMALS), animalData);
                    showModal("Sucesso", `Animal ${animalData.nome} adicionado ao Firebase!`);
                }
                
                modal.classList.add('hidden');
                e.target.reset();
            } catch (error) {
                console.error("Erro ao salvar animal:", error);
                showModal("Erro", "Falha ao salvar o animal. Verifique suas regras de seguran√ßa do Firestore.");
            }
        }

        /** Deleta um animal do Firestore. */
        async function deleteAnimal(id, nome) {
            if (!isAdminLoggedIn) { showModal("Acesso Negado", "Voc√™ precisa estar logado como Admin."); return; }

            const isConfirmed = await showConfirmModal("Confirmar Exclus√£o", `Tem certeza que deseja remover o animal ${nome}? Esta a√ß√£o √© irrevers√≠vel.`);
            
            if (!isConfirmed) return;

            try {
                const animalRef = doc(db, COLLECTIONS.ANIMALS, id);
                await deleteDoc(animalRef);
                showModal("Sucesso", `Animal ${nome} removido do Firebase!`);
            } catch (error) {
                console.error("Erro ao deletar animal:", error);
                showModal("Erro", "Falha ao deletar o animal. Verifique suas regras de seguran√ßa do Firestore.");
            }
        }


        // =======================================================
        // 5. GERENCIAMENTO DE INTERESSES (Firestore)
        // =======================================================

        const adoptionInterestForm = document.getElementById('adoption-interest-form');

        function openAdoptionModal(animalId, animalName) {
            document.getElementById('interest-animal-name').textContent = animalName;
            adoptionInterestForm.dataset.animalId = animalId;
            adoptionInterestForm.dataset.animalName = animalName;
            document.getElementById('adoption-modal').classList.remove('hidden');
            document.getElementById('adoption-interest-error').textContent = '';
        }

        document.getElementById('adoption-modal-close').addEventListener('click', () => {
            document.getElementById('adoption-modal').classList.add('hidden');
            adoptionInterestForm.reset();
        });

        adoptionInterestForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const animalId = adoptionInterestForm.dataset.animalId;
            const animalName = adoptionInterestForm.dataset.animalName;
            
            const data = {
                nome: e.target.interestName.value.trim(),
                telefone: e.target.interestPhone.value.trim(),
                email: e.target.interestEmail.value.trim() || 'N√£o fornecido',
                dataSubmissao: new Date().getTime(),
                animalId: animalId,
                animalNome: animalName,
                status: 'pendente'
            };
            
            const errorElement = document.getElementById('adoption-interest-error');
            errorElement.textContent = '';

            if (!data.nome || !data.telefone) {
                errorElement.textContent = 'Nome e Telefone s√£o campos obrigat√≥rios.';
                return;
            }

            try {
                await addDoc(collection(db, COLLECTIONS.INTERESTS), data);
                showModal("Obrigado!", `Seu interesse em ${animalName} foi registrado no Firebase! O Admin ver√° em breve.`);
                document.getElementById('adoption-modal').classList.add('hidden');
                adoptionInterestForm.reset();
            } catch (error) {
                 console.error("Erro ao registrar interesse:", error);
                showModal("Erro", "Falha ao registrar interesse. Verifique suas regras de seguran√ßa do Firestore (escrita p√∫blica).");
            }
        });
        
        // Listener para deletar interesse (marcar como tratado)
        document.getElementById('adoption-interests-list').addEventListener('click', async (e) => {
            const btn = e.target.closest('.delete-interest-btn');
            if (btn) {
                 if (!isAdminLoggedIn) { showModal("Acesso Negado", "Voc√™ precisa estar logado como Admin."); return; }
                const id = btn.dataset.id;

                const isConfirmed = await showConfirmModal("Marcar como Tratado", "Marcar este interesse como tratado e remover da lista? (Esta a√ß√£o √© irrevers√≠vel)");
                
                if (!isConfirmed) return;

                try {
                    const interestRef = doc(db, COLLECTIONS.INTERESTS, id);
                    await deleteDoc(interestRef);
                    showModal("Sucesso", "Interesse removido do Firebase.");
                } catch (error) {
                    console.error("Erro ao deletar interesse:", error);
                    showModal("Erro", "Falha ao remover interesse. Verifique suas regras de seguran√ßa do Firestore.");
                }
            }
        });


        // =======================================================
        // 6. CONFIGURA√á√ïES GLOBAIS E CONTADORES (Firestore)
        // =======================================================

        /** Popula o formul√°rio de contadores gerenciados com dados atuais */
        function populateManagedCountersForm() {
            const form = document.getElementById('managed-counters-form');
            if (form) {
                form.querySelector('#resgatados').value = appStatus.resgatados_count || 0;
                form.querySelector('#adotados').value = appStatus.adotados_count || 0;
                form.querySelector('#aguardando').value = appStatus.aguardando_adocao_count || 0;
            }
        }

        document.getElementById('managed-counters-form').addEventListener('submit', async (e) => {
            e.preventDefault();
             if (!isAdminLoggedIn) { showModal("Acesso Negado", "Voc√™ precisa estar logado como Admin."); return; }

            const data = {
                resgatados_count: parseInt(e.target.resgatados.value) || 0,
                adotados_count: parseInt(e.target.adotados.value) || 0,
                aguardando_adocao_count: parseInt(e.target.aguardando.value) || 0,
            };
            
            try {
                await updateDoc(statusDocRef, data);
                showModal("Sucesso", "Contadores de Resgate/Ado√ß√£o atualizados no Firebase!");
            } catch (error) {
                console.error("Erro ao atualizar contadores:", error);
                showModal("Erro", "Falha ao atualizar contadores. Verifique suas regras de seguran√ßa do Firestore.");
            }
        });

        /** Popula o formul√°rio de configura√ß√µes globais com dados atuais */
        function populateGlobalConfigForm() {
            const form = document.getElementById('global-config-form');
            if (form) {
                form.querySelector('#contact-email').value = appConfig.email || '';
                form.querySelector('#contact-phone').value = appConfig.telefone || '';
                form.querySelector('#contact-instagram').value = appConfig.instagram || '';
                form.querySelector('#maps-link').value = appConfig.mapsLink || '';
                form.querySelector('#presentation-text-input').value = appStatus.presentation_text || '';
            }
        }

        document.getElementById('global-config-form').addEventListener('submit', async (e) => {
            e.preventDefault();
             if (!isAdminLoggedIn) { showModal("Acesso Negado", "Voc√™ precisa estar logado como Admin."); return; }

            const configData = {
                email: e.target.querySelector('#contact-email').value.trim(),
                telefone: e.target.querySelector('#contact-phone').value.trim(),
                instagram: e.target.querySelector('#contact-instagram').value.trim(),
                mapsLink: e.target.querySelector('#maps-link').value.trim()
            };
            
            const statusData = {
                presentation_text: e.target.querySelector('#presentation-text-input').value.trim()
            };

            try {
                // Atualiza Config
                await updateDoc(configDocRef, configData);
                // Atualiza Status (Texto de Apresenta√ß√£o)
                await updateDoc(statusDocRef, statusData);

                showModal("Sucesso", "Configura√ß√µes Globais atualizadas no Firebase!");
            } catch (error) {
                console.error("Erro ao atualizar configura√ß√µes:", error);
                showModal("Erro", "Falha ao atualizar configura√ß√µes. Verifique suas regras de seguran√ßa do Firestore.");
            }
        });


        // =======================================================
        // 7. FUN√á√ïES DE MODAL
        // =======================================================

        function showModal(title, message) {
            document.getElementById('modal-title').textContent = title;
            document.getElementById('modal-message').textContent = message;
            document.getElementById('global-modal').classList.remove('hidden');
        }

        document.getElementById('modal-close').addEventListener('click', () => {
            document.getElementById('global-modal').classList.add('hidden');
        });
        
        function showConfirmModal(title, message) {
            return new Promise(resolve => {
                const confirmModal = document.getElementById('confirm-modal');
                const confirmTitle = document.getElementById('confirm-modal-title');
                const confirmMessage = document.getElementById('confirm-modal-message');
                const confirmYes = document.getElementById('confirm-yes');
                const confirmNo = document.getElementById('confirm-no');

                confirmTitle.textContent = title;
                confirmMessage.textContent = message;
                confirmModal.classList.remove('hidden');

                const handleYes = () => {
                    confirmModal.classList.add('hidden');
                    confirmYes.removeEventListener('click', handleYes);
                    confirmNo.removeEventListener('click', handleNo);
                    resolve(true);
                };

                const handleNo = () => {
                    confirmModal.classList.add('hidden');
                    confirmYes.removeEventListener('click', handleYes);
                    confirmNo.removeEventListener('click', handleNo);
                    resolve(false);
                };

                confirmYes.addEventListener('click', handleYes);
                confirmNo.addEventListener('click', handleNo);
            });
        }


        // Chamar a fun√ß√£o de inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', () => {
            loadInitialData(); // Carrega dados iniciais e incrementa views
            
            // Inicia o listener de animais e interesses para o caso de j√° estar logado
            startRealtimeListeners(); 
            
            // onAuthStateChanged cuidar√° da defini√ß√£o inicial da view ('public' ou 'admin')
            // Se n√£o estiver logado, a view ser√° 'public' por padr√£o.
        });
    </script>
</head>
<body class="min-h-screen">

    <header id="main-header" class="sticky top-0 z-40 shadow-md bg-white dark:bg-gray-900 border-b border-rose-100 dark:border-rose-900">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 flex justify-between items-center relative">
            <h1 class="text-3xl font-extrabold text-rose-500 flex items-center space-x-2">
                <i data-lucide="paw-print" class="w-8 h-8"></i>
                <span>S.O.S Viralatas</span>
            </h1>
            <div class="flex space-x-3 items-center">
                <button id="theme-toggle" class="p-3 rounded-full transition-colors bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600">
                    <i data-lucide="moon" class="w-6 h-6 text-gray-800"></i>
                </button>
                <button id="toggle-admin" class="p-3 rounded-full transition-colors bg-rose-400 text-gray-800 hover:bg-rose-500 shadow-lg">
                    <i data-lucide="settings" class="w-6 h-6"></i>
                </button>
            </div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10">

        <section id="public-section" class="space-y-12">
            
            <div class="text-center py-10 bg-rose-50 dark:bg-gray-800 rounded-3xl shadow-xl border border-rose-200 dark:border-gray-700">
                <h2 class="text-4xl md:text-5xl font-extrabold text-sky-600 dark:text-sky-400 mb-4">
                    Amor Resgata. Amor Acolhe.
                </h2>
                <p id="presentation-text" class="max-w-3xl mx-auto text-lg text-gray-700 dark:text-gray-300">
                    Carregando texto de apresenta√ß√£o...
                </p>
            </div>

            <h3 class="text-3xl font-bold text-gray-800 dark:text-gray-100 mt-12 mb-6">Nossos N√∫meros</h3>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-8">
                <div class="bg-rose-50 dark:bg-rose-950 p-6 rounded-2xl text-center shadow-lg border border-rose-200 dark:border-rose-800">
                    <p class="text-4xl font-extrabold text-rose-600 dark:text-rose-400" id="resgatados-count">0</p>
                    <p class="mt-2 text-sm font-semibold text-gray-600 dark:text-gray-300">Resgatados</p>
                </div>
                <div class="bg-rose-50 dark:bg-rose-950 p-6 rounded-2xl text-center shadow-lg border border-rose-200 dark:border-rose-800">
                    <p class="text-4xl font-extrabold text-rose-600 dark:text-rose-400" id="adotados-count">0</p>
                    <p class="mt-2 text-sm font-semibold text-gray-600 dark:text-gray-300">Adotados</p>
                </div>
                <div class="bg-sky-50 dark:bg-sky-950 p-6 rounded-2xl text-center shadow-lg border border-sky-200 dark:border-sky-800">
                    <p class="text-4xl font-extrabold text-sky-600 dark:text-sky-400" id="adocao-count">0</p>
                    <p class="mt-2 text-sm font-semibold text-gray-600 dark:text-gray-300">Aguardando Ado√ß√µes</p>
                </div>
                <div class="bg-gray-50 dark:bg-gray-700 p-6 rounded-2xl text-center shadow-lg border border-gray-200 dark:border-gray-600">
                    <p class="text-4xl font-extrabold text-gray-600 dark:text-gray-300" id="site-views-count">0</p>
                    <p class="mt-2 text-sm font-semibold text-gray-600 dark:text-gray-300">Visitas ao Site</p>
                </div>
            </div>

            <h3 class="text-3xl font-bold text-gray-800 dark:text-gray-100 mt-12 mb-6">Nossos Amigos</h3>
            <div id="animals-list-public" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
                </div>

            <h3 class="text-3xl font-bold text-gray-800 dark:text-gray-100 mt-12 mb-6">Entre em Contato</h3>
            <div class="bg-sky-50 dark:bg-gray-800 p-8 rounded-2xl shadow-xl border border-sky-200 dark:border-gray-700 grid grid-cols-1 md:grid-cols-3 gap-6 text-center">
                <div>
                    <i data-lucide="mail" class="w-8 h-8 text-rose-500 mx-auto mb-2"></i>
                    <p class="font-bold text-lg">Email</p>
                    <p id="public-email" class="text-gray-700 dark:text-gray-300">Carregando...</p>
                </div>
                <div>
                    <i data-lucide="phone" class="w-8 h-8 text-rose-500 mx-auto mb-2"></i>
                    <p class="font-bold text-lg">Telefone</p>
                    <p id="public-phone" class="text-gray-700 dark:text-gray-300">Carregando...</p>
                </div>
                <div>
                    <i data-lucide="instagram" class="w-8 h-8 text-rose-500 mx-auto mb-2"></i>
                    <p class="font-bold text-lg">Instagram</p>
                    <p id="public-instagram" class="text-gray-700 dark:text-gray-300">Carregando...</p>
                </div>
            </div>
            
            <div class="text-center mt-8">
                <a id="public-maps-link" href="#" target="_blank" class="inline-flex items-center bg-sky-500 hover:bg-sky-600 text-white font-bold py-3 px-6 rounded-lg transition-colors shadow-lg space-x-2">
                    <i data-lucide="map-pin" class="w-5 h-5"></i>
                    <span>Ver Localiza√ß√£o no Mapa</span>
                </a>
            </div>

        </section>

        <section id="login-section" class="hidden max-w-lg mx-auto py-20">
            <div class="bg-white dark:bg-gray-800 p-8 rounded-2xl shadow-2xl border border-sky-100 dark:border-sky-800">
                <h2 class="text-3xl font-bold text-sky-600 dark:text-sky-400 mb-6 text-center">Login Administrativo (Firebase)</h2>
                <form id="admin-login-form" class="space-y-6">
                    <div>
                        <label for="email" class="block text-sm font-medium mb-1">Email</label>
                        <input type="email" id="email" name="email" class="w-full p-3 border border-gray-300 dark:border-gray-600 input-style bg-gray-50 dark:bg-gray-700 dark:text-gray-100" required>
                    </div>
                    <div>
                        <label for="password" class="block text-sm font-medium mb-1">Senha</label>
                        <input type="password" id="password" name="password" class="w-full p-3 border border-gray-300 dark:border-gray-600 input-style bg-gray-50 dark:bg-gray-700 dark:text-gray-100" required>
                    </div>

                    <p id="login-error-message" class="text-red-500 text-sm font-semibold h-5"></p>
                    <button type="submit" class="w-full bg-rose-500 hover:bg-rose-600 text-white font-bold py-3 rounded-lg transition-colors shadow-md flex items-center justify-center space-x-2">
                        <i data-lucide="log-in" class="w-5 h-5"></i>
                        <span>Entrar</span>
                    </button>
                </form>
            </div>
        </section>

        <section id="admin-section" class="hidden">
            <h2 class="text-4xl font-extrabold text-sky-600 dark:text-sky-400 mb-8 flex justify-between items-center">
                Painel Administrativo
                <span class="text-sm font-medium text-gray-500 dark:text-gray-400">Usu√°rio ID: <span id="current-user-id">Carregando...</span></span>
            </h2>

            <div id="admin-nav" class="flex space-x-2 mb-8 p-2 rounded-xl bg-gray-100 dark:bg-gray-700 shadow-inner">
                <button data-view="dashboard" class="flex-1 p-3 rounded-lg text-sm font-semibold transition-colors bg-sky-500 text-white">
                    <i data-lucide="layout-dashboard" class="w-5 h-5 inline mr-2"></i> Dashboard
                </button>
                <button data-view="animals" class="flex-1 p-3 rounded-lg text-sm font-semibold transition-colors bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200">
                    <i data-lucide="dog" class="w-5 h-5 inline mr-2"></i> Animais
                </button>
                <button data-view="config" class="flex-1 p-3 rounded-lg text-sm font-semibold transition-colors bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200">
                    <i data-lucide="cog" class="w-5 h-5 inline mr-2"></i> Configura√ß√µes
                </button>
            </div>

            <div id="admin-dashboard-block" class="space-y-8">
                <h3 class="text-2xl font-bold text-gray-800 dark:text-gray-100">Vis√£o Geral</h3>
                
                <div class="grid grid-cols-2 lg:grid-cols-4 gap-4">
                    <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-lg border border-rose-100 dark:border-rose-900 flex items-center justify-between">
                        <div>
                            <p class="text-sm font-semibold text-gray-500 dark:text-gray-400">Em Ado√ß√£o</p>
                            <p class="text-3xl font-bold text-rose-500" id="admin-available-animals">0</p>
                        </div>
                        <i data-lucide="list-checks" class="w-8 h-8 text-rose-300"></i>
                    </div>
                    <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-lg border border-sky-100 dark:border-sky-800 flex items-center justify-between">
                        <div>
                            <p class="text-sm font-semibold text-gray-500 dark:text-gray-400">Interessados</p>
                            <p class="text-3xl font-bold text-sky-500" id="interests-count">0</p>
                        </div>
                        <i data-lucide="message-circle-heart" class="w-8 h-8 text-sky-300"></i>
                    </div>
                    <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 flex items-center justify-between">
                        <div>
                            <p class="text-sm font-semibold text-gray-500 dark:text-gray-400">Visitas</p>
                            <p class="text-3xl font-bold text-gray-600 dark:text-gray-300" id="admin-views-count">0</p>
                        </div>
                        <i data-lucide="eye" class="w-8 h-8 text-gray-400"></i>
                    </div>
                    <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-lg border border-rose-100 dark:border-rose-900 flex items-center justify-between">
                        <div>
                            <p class="text-sm font-semibold text-gray-500 dark:text-gray-400">Total Adotados</p>
                            <p class="text-3xl font-bold text-rose-500" id="adotados-count-dashboard">0</p>
                        </div>
                        <i data-lucide="home" class="w-8 h-8 text-rose-300"></i>
                    </div>
                </div>

                <h3 class="text-2xl font-bold text-gray-800 dark:text-gray-100 pt-6">Interesses de Ado√ß√£o Recentes (Firebase)</h3>
                <ul id="adoption-interests-list" class="space-y-4">
                    </ul>
            </div>

            <div id="admin-animals-block" class="hidden space-y-8">
                <h3 class="text-2xl font-bold text-gray-800 dark:text-gray-100 flex justify-between items-center">
                    Gerenciar Animais
                    <button id="add-animal-btn" class="bg-rose-500 hover:bg-rose-600 text-white font-bold py-2 px-4 rounded-lg transition-colors flex items-center space-x-2 shadow-md">
                        <i data-lucide="plus" class="w-5 h-5"></i>
                        <span>Novo Animal</span>
                    </button>
                </h3>
                <ul id="animals-list-admin" class="space-y-4">
                    </ul>
            </div>

            <div id="admin-config-block" class="hidden space-y-8">
                <h3 class="text-2xl font-bold text-gray-800 dark:text-gray-100">Ajustes da Aplica√ß√£o</h3>

                <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-lg border border-sky-100 dark:border-sky-800">
                    <h4 class="text-xl font-semibold text-sky-600 dark:text-sky-400 mb-4">Contadores de Resgate e Ado√ß√£o</h4>
                    <form id="managed-counters-form" class="space-y-4">
                        <div class="grid grid-cols-3 gap-4">
                            <div>
                                <label for="resgatados" class="block text-sm font-medium mb-1">Total Resgatados</label>
                                <input type="number" id="resgatados" name="resgatados" class="w-full p-2 border border-gray-300 dark:border-gray-600 input-style bg-gray-50 dark:bg-gray-700 dark:text-gray-100" required>
                            </div>
                            <div>
                                <label for="adotados" class="block text-sm font-medium mb-1">Total Adotados</label>
                                <input type="number" id="adotados" name="adotados" class="w-full p-2 border border-gray-300 dark:border-gray-600 input-style bg-gray-50 dark:bg-gray-700 dark:text-gray-100" required>
                            </div>
                            <div>
                                <label for="aguardando" class="block text-sm font-medium mb-1">Aguardando Ado√ß√µes</label>
                                <input type="number" id="aguardando" name="aguardando" class="w-full p-2 border border-gray-300 dark:border-gray-600 input-style bg-gray-50 dark:bg-gray-700 dark:text-gray-100" required>
                            </div>
                        </div>
                        <div class="pt-4">
                            <button type="submit" class="bg-rose-500 hover:bg-rose-600 text-white font-bold py-2 px-4 rounded-lg transition-colors shadow-md">
                                Salvar Contadores no Firebase
                            </button>
                        </div>
                    </form>
                </div>

                <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-lg border border-sky-100 dark:border-sky-800">
                    <h4 class="text-xl font-semibold text-sky-600 dark:text-sky-400 mb-4">Informa√ß√µes P√∫blicas e Contato</h4>
                    <form id="global-config-form" class="space-y-4">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label for="contact-email" class="block text-sm font-medium mb-1">Email de Contato</label>
                                <input type="email" id="contact-email" class="w-full p-2 border border-gray-300 dark:border-gray-600 input-style bg-gray-50 dark:bg-gray-700 dark:text-gray-100" required>
                            </div>
                            <div>
                                <label for="contact-phone" class="block text-sm font-medium mb-1">Telefone (Whatsapp)</label>
                                <input type="text" id="contact-phone" class="w-full p-2 border border-gray-300 dark:border-gray-600 input-style bg-gray-50 dark:bg-gray-700 dark:text-gray-100" required>
                            </div>
                            <div>
                                <label for="contact-instagram" class="block text-sm font-medium mb-1">Instagram (@usuario)</label>
                                <input type="text" id="contact-instagram" class="w-full p-2 border border-gray-300 dark:border-gray-600 input-style bg-gray-50 dark:bg-gray-700 dark:text-gray-100" required>
                            </div>
                            <div>
                                <label for="maps-link" class="block text-sm font-medium mb-1">Link do Google Maps</label>
                                <input type="url" id="maps-link" class="w-full p-2 border border-gray-300 dark:border-gray-600 input-style bg-gray-50 dark:bg-gray-700 dark:text-gray-100" required>
                            </div>
                        </div>
                        
                        <div class="pt-2">
                            <label for="presentation-text-input" class="block text-sm font-medium mb-1">Texto de Apresenta√ß√£o Principal</label>
                            <textarea id="presentation-text-input" rows="3" class="w-full p-2 border border-gray-300 dark:border-gray-600 input-style bg-gray-50 dark:bg-gray-700 dark:text-gray-100" required></textarea>
                        </div>
                        
                        <div class="pt-4">
                            <button type="submit" class="bg-rose-500 hover:bg-rose-600 text-white font-bold py-2 px-4 rounded-lg transition-colors shadow-md">
                                Salvar Informa√ß√µes no Firebase
                            </button>
                        </div>
                    </form>
                </div>
            </div>

        </section>
    </main>


    <div id="global-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4 transition-opacity duration-300">
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-sm p-6 transform scale-100 transition-transform duration-300 border-t-4 border-rose-500 dark:border-rose-400">
            <h3 id="modal-title" class="text-xl font-bold text-gray-800 dark:text-gray-100 mb-3">T√≠tulo</h3>
            <p id="modal-message" class="text-gray-600 dark:text-gray-300 mb-6">Mensagem</p>
            <div class="flex justify-end">
                <button id="modal-close" class="bg-rose-500 hover:bg-rose-600 text-white font-bold py-2 px-4 rounded-lg transition-colors">Fechar</button>
            </div>
        </div>
    </div>

    <div id="confirm-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4 transition-opacity duration-300">
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-sm p-6 transform scale-100 transition-transform duration-300 border-t-4 border-sky-500 dark:border-sky-400">
            <h3 id="confirm-modal-title" class="text-xl font-bold text-gray-800 dark:text-gray-100 mb-3">Confirmar</h3>
            <p id="confirm-modal-message" class="text-gray-600 dark:text-gray-300 mb-6">Tem certeza?</p>
            <div class="flex justify-end space-x-3">
                <button id="confirm-no" class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded-lg transition-colors">N√£o</button>
                <button id="confirm-yes" class="bg-sky-500 hover:bg-sky-600 text-white font-bold py-2 px-4 rounded-lg transition-colors">Sim</button>
            </div>
        </div>
    </div>

    <div id="animal-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4 transition-opacity duration-300 overflow-y-auto">
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-lg p-6 my-10 transform transition-transform duration-300 border-t-4 border-rose-500 dark:border-rose-400">
            <div class="flex justify-between items-center mb-6">
                <h3 id="animal-form-title" class="text-2xl font-bold text-rose-500 dark:text-rose-400">Adicionar Novo Animal</h3>
                <button id="animal-modal-close" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-200">
                    <i data-lucide="x" class="w-6 h-6"></i>
                </button>
            </div>
            <form id="animal-form" class="space-y-4">
                <div>
                    <label for="nome" class="block text-sm font-medium mb-1">Nome</label>
                    <input type="text" id="nome" name="nome" class="w-full p-2 border border-gray-300 dark:border-gray-600 input-style bg-gray-50 dark:bg-gray-700 dark:text-gray-100" required>
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label for="raca" class="block text-sm font-medium mb-1">Ra√ßa / Tipo</label>
                        <input type="text" id="raca" name="raca" class="w-full p-2 border border-gray-300 dark:border-gray-600 input-style bg-gray-50 dark:bg-gray-700 dark:text-gray-100" required>
                    </div>
                    <div>
                        <label for="idade" class="block text-sm font-medium mb-1">Idade (anos)</label>
                        <input type="number" id="idade" name="idade" class="w-full p-2 border border-gray-300 dark:border-gray-600 input-style bg-gray-50 dark:bg-gray-700 dark:text-gray-100" required min="0">
                    </div>
                </div>
                <div>
                    <label for="sexo" class="block text-sm font-medium mb-1">Sexo</label>
                    <select id="sexo" name="sexo" class="w-full p-2 border border-gray-300 dark:border-gray-600 input-style bg-gray-50 dark:bg-gray-700 dark:text-gray-100" required>
                        <option value="Macho">Macho</option>
                        <option value="F√™mea">F√™mea</option>
                    </select>
                </div>
                <div>
                    <label for="imagemUrl" class="block text-sm font-medium mb-1">URL da Imagem</label>
                    <input type="url" id="imagemUrl" name="imagemUrl" class="w-full p-2 border border-gray-300 dark:border-gray-600 input-style bg-gray-50 dark:bg-gray-700 dark:text-gray-100">
                </div>
                <div>
                    <label for="descricao" class="block text-sm font-medium mb-1">Descri√ß√£o</label>
                    <textarea id="descricao" name="descricao" rows="4" class="w-full p-2 border border-gray-300 dark:border-gray-600 input-style bg-gray-50 dark:bg-gray-700 dark:text-gray-100" required></textarea>
                </div>
                <div class="pt-4">
                    <button type="submit" class="w-full bg-rose-500 hover:bg-rose-600 text-white font-bold py-3 rounded-lg transition-colors shadow-md">
                        Salvar Animal no Firebase
                    </button>
                </div>
            </form>
        </div>
    </div>
    
    <div id="adoption-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4 transition-opacity duration-300 overflow-y-auto">
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-sm p-6 my-10 transform transition-transform duration-300 border-t-4 border-sky-500 dark:border-sky-400">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold text-sky-500 dark:text-sky-400">Interesse em Adotar</h3>
                <button id="adoption-modal-close" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-200">
                    <i data-lucide="x" class="w-6 h-6"></i>
                </button>
            </div>
            <p class="mb-4 text-gray-600 dark:text-gray-300">Voc√™ est√° manifestando interesse em <span id="interest-animal-name" class="font-bold text-rose-500">...</span>. Preencha seus dados para contato:</p>
            <form id="adoption-interest-form" class="space-y-4" data-animal-id="" data-animal-name="">
                <div>
                    <label for="interestName" class="block text-sm font-medium mb-1">Seu Nome Completo</label>
                    <input type="text" id="interestName" name="interestName" class="w-full p-2 border border-gray-300 dark:border-gray-600 input-style bg-gray-50 dark:bg-gray-700 dark:text-gray-100" required>
                </div>
                <div>
                    <label for="interestPhone" class="block text-sm font-medium mb-1">Telefone / WhatsApp</label>
                    <input type="tel" id="interestPhone" name="interestPhone" class="w-full p-2 border border-gray-300 dark:border-gray-600 input-style bg-gray-50 dark:bg-gray-700 dark:text-gray-100" required>
                </div>
                <div>
                    <label for="interestEmail" class="block text-sm font-medium mb-1">Email (Opcional)</label>
                    <input type="email" id="interestEmail" name="interestEmail" class="w-full p-2 border border-gray-300 dark:border-gray-600 input-style bg-gray-50 dark:bg-gray-700 dark:text-gray-100">
                </div>
                <p id="adoption-interest-error" class="text-red-500 text-sm font-semibold h-5"></p>
                <div class="pt-4">
                    <button type="submit" class="w-full bg-sky-500 hover:bg-sky-600 text-white font-bold py-3 rounded-lg transition-colors shadow-md">
                        Registrar Interesse (Salvar no Firebase)
                    </button>
                </div>
            </form>
        </div>
    </div>


    <footer class="text-center py-6 border-t border-gray-200 dark:border-gray-700 text-sm text-gray-500 dark:text-gray-400 mt-12">
        ¬© 2025 S.O.S Viralatas by Andrea. Todos os direitos reservados.
    </footer>

</body>
</html>
